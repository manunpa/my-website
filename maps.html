<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>Customer Stations Map</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
Â  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
Â  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
Â  <style>
Â  Â  body, html, #app {
Â  Â  Â  height: 100%; margin: 0;
Â  Â  Â  background: linear-gradient(135deg, #0f0f2f, #1a1a2e);
Â  Â  Â  color: #00ffff;
Â  Â  Â  font-family: 'Courier New', monospace;
Â  Â  }
Â  Â  #map {
Â  Â  Â  height: 100%;
Â  Â  Â  border-radius: 0 0 0.5rem 0;
Â  Â  Â  box-shadow: 0 0 15px #00ffffaa;
Â  Â  }
Â  Â  #leftPanel::-webkit-scrollbar { width: 8px; }
Â  Â  #leftPanel::-webkit-scrollbar-thumb {
Â  Â  Â  background-color: #00ffffaa;
Â  Â  Â  border-radius: 4px;
Â  Â  }
Â  Â  /* à¹€à¸à¸´à¹ˆà¸¡à¸•à¸£à¸‡à¸™à¸µà¹‰à¹€à¸¥à¸¢à¸„à¸£à¸±à¸š à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ªà¸µà¸•à¸±à¸§à¹€à¸¥à¸‚à¸à¸¥à¸¸à¹ˆà¸¡à¸«à¸¡à¸¸à¸”à¹€à¸›à¹‡à¸™à¸ªà¸µà¸”à¸³ */
Â  Â  .marker-cluster div {
Â  Â  Â  color: black !important;
Â  Â  Â  text-shadow: none !important;
Â  Â  }

Â  Â  @media (max-width: 768px) {
Â  Â  Â  #app > div.flex-1 { flex-direction: column; height: 100%; }
Â  Â  Â  #leftPanel {
Â  Â  Â  Â  width: 100% !important;
Â  Â  Â  Â  height: 200px;
Â  Â  Â  Â  border-right: none;
Â  Â  Â  Â  border-bottom: 2px solid #00ffffaa;
Â  Â  Â  Â  overflow-x: auto; overflow-y: hidden;
Â  Â  Â  Â  flex-shrink: 0;
Â  Â  Â  }
Â  Â  Â  main {
Â  Â  Â  Â  height: calc(100% - 200px);
Â  Â  Â  Â  flex: 1 1 auto; min-height: 0;
Â  Â  Â  }
Â  Â  }
Â  </style>
</head>
<body>
<div id="app" class="flex flex-col h-full">
Â  <header class="flex items-center justify-between bg-[#001F3F] px-6 py-3 shadow-md">
Â  Â  <div class="text-xl font-semibold tracking-wide">ğŸ›¡ï¸ Customer Stations Map</div>
Â  Â  <nav class="space-x-6 text-cyan-300 flex items-center">
Â  Â  Â  <button class="hover:text-cyan-100 transition">Home</button>
Â  Â  Â  <button class="hover:text-cyan-100 transition">Fleet</button>
Â  Â  Â  <button class="hover:text-cyan-100 transition">Settings</button>
Â  Â  Â  <button id="logoutBtn" class="ml-8 px-5 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition shadow-lg border-2 border-cyan-400">
Â  Â  Â  Â  Logout
Â  Â  Â  </button>
Â  Â  </nav>
Â  </header>
Â  <div class="flex-1 overflow-hidden flex">
Â  Â  <aside id="leftPanel" class="w-72 bg-[#002244] p-4 overflow-y-auto border-r border-cyan-600 flex flex-col">
Â  Â  Â  <h2 class="mb-4 font-bold text-cyan-300 text-lg">ğŸš— Station List</h2>
Â  Â  Â  <input type="text" id="searchInput" placeholder="à¸„à¹‰à¸™à¸«à¸²à¸ªà¸–à¸²à¸™à¸µ..." class="mb-4 p-2 rounded bg-[#003355] text-cyan-100 placeholder-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-400"/>
Â  Â  Â  <ul id="vehicleList" class="space-y-3 overflow-y-auto flex-1"></ul>
Â  Â  </aside>
Â  Â  <main class="flex-1 relative flex flex-col">
Â  Â  Â  <div class="p-2 bg-[#001F3F] text-cyan-300 flex items-center space-x-3 border-b border-cyan-600">
Â  Â  Â  Â  <label for="layerSelect" class="font-semibold select-none">à¹à¸œà¸™à¸—à¸µà¹ˆ:</label>
Â  Â  Â  Â  <select id="layerSelect" class="bg-[#003355] text-cyan-200 rounded px-2 py-1 focus:outline-none">
Â  Â  Â  Â  Â  <option value="osm">OpenStreetMap</option>
Â  Â  Â  Â  Â  <option value="satellite">à¸”à¸²à¸§à¹€à¸—à¸µà¸¢à¸¡</option>
Â  Â  Â  Â  </select>
Â  Â  Â  </div>
Â  Â  Â  <div id="map" class="flex-1"></div>
Â  Â  </main>
Â  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<script type="module">
Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
Â  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-auth.js";

Â  const firebaseConfig = {
Â  Â  apiKey: "AIzaSyD7HPOhloICyxEyDTfR8yRiH2rT--q4fVo",
Â  Â  authDomain: "my-login-project-26857.firebaseapp.com",
Â  Â  projectId: "my-login-project-26857",
Â  Â  storageBucket: "my-login-project-26857.appspot.com",
Â  Â  messagingSenderId: "199741800244",
Â  Â  appId: "1:199741800244:web:41b413f67038c687dc2f61"
Â  };

Â  const app = initializeApp(firebaseConfig);
Â  const auth = getAuth(app);

onAuthStateChanged(auth, user => {
Â  if (!user) {
Â  Â  alert("ğŸš« Access denied. Please log in first.");
Â  Â  window.location.href = "index.html";
Â  } else {
Â  Â  // âœ… à¹€à¸£à¸´à¹ˆà¸¡à¸ˆà¸±à¸šà¹€à¸§à¸¥à¸²à¹€à¸¡à¸·à¹ˆà¸­à¸¢à¸·à¸™à¸¢à¸±à¸™à¸§à¹ˆà¸² user à¸¥à¹‡à¸­à¸à¸­à¸´à¸™à¹à¸¥à¹‰à¸§
Â  Â  setTimeout(async () => {
Â  Â  Â  try {
Â  Â  Â  Â  await signOut(auth);
Â  Â  Â  Â  alert("â³ Session expired. You have been logged out.");
Â  Â  Â  Â  window.location.href = "index.html";
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  alert("âŒ Auto logout failed: " + error.message);
Â  Â  Â  Â  window.location.href = "index.html";
Â  Â  Â  }
Â  Â  }, 10 * 60 * 1000); // 10 à¸™à¸²à¸—à¸µ
Â  }
});


Â  let vehicles = [];
Â  const markers = L.markerClusterGroup();
Â  const map = L.map('map').setView([13.7563, 100.5018], 13);

Â  const osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
Â  Â  attribution: 'Â© OpenStreetMap contributors'
Â  });

Â  const satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
Â  Â  attribution: 'Tiles Â© Esri â€” Source: Esri'
Â  });

Â  osmLayer.addTo(map);
Â  map.addLayer(markers);

Â  document.getElementById('layerSelect').addEventListener('change', e => {
Â  Â  map.eachLayer(layer => map.removeLayer(layer));
Â  Â  if (e.target.value === 'osm') osmLayer.addTo(map);
Â  Â  else if (e.target.value === 'satellite') satelliteLayer.addTo(map);
Â  Â  map.addLayer(markers);
Â  });

Â  const carIcon = L.icon({
Â  Â  iconUrl: 'https://www.freepnglogos.com/uploads/mr-bean-png/mr-bean-bean-waving-transparent-png-stickpng-2.png',
Â  Â  iconSize: [40, 40],
Â  Â  iconAnchor: [20, 20],
Â  Â  popupAnchor: [0, -20]
Â  });

Â  const vehicleListEl = document.getElementById('vehicleList');
Â  const searchInput = document.getElementById('searchInput');

Â  function displayVehicles(filter = '') {
Â  Â  vehicleListEl.innerHTML = '';
Â  Â  markers.clearLayers();
Â  Â  const filtered = vehicles.filter(v => v.name.toLowerCase().includes(filter.toLowerCase()));
Â  Â  filtered.forEach(v => {
Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  li.textContent = v.name;
Â  Â  Â  li.className = 'cursor-pointer px-3 py-2 rounded bg-[#003355] hover:bg-cyan-600 transition';
Â  Â  Â  li.onclick = () => {
Â  Â  Â  Â  map.setView([v.lat, v.lng], 15);
Â  Â  Â  };
Â  Â  Â  vehicleListEl.appendChild(li);

Â  Â  Â  const marker = L.marker([v.lat, v.lng], { icon: carIcon })
Â  Â  Â  Â  .bindPopup(`<b>${v.name}</b><br>Lat: ${v.lat.toFixed(6)}<br>Lng: ${v.lng.toFixed(6)}`)
Â  Â  Â  Â  .bindTooltip(`Lat: ${v.lat.toFixed(6)}, Lng: ${v.lng.toFixed(6)}`);
Â  Â  Â  markers.addLayer(marker);
Â  Â  });
Â  }

Â  searchInput.addEventListener('input', e => {
Â  Â  displayVehicles(e.target.value);
Â  });

Â  async function loadCSV() {
Â  Â  try {
Â  Â  Â  const response = await fetch('data/stations.csv');
Â  Â  Â  if (!response.ok) throw new Error('Failed to load CSV data');
Â  Â  Â  const csvText = await response.text();
Â  Â  Â  const parsed = Papa.parse(csvText, { header: true, skipEmptyLines: true });
Â  Â  Â  vehicles = parsed.data.map(row => ({
Â  Â  Â  Â  name: row.name || row.Name || row.NAME,
Â  Â  Â  Â  lat: parseFloat(row.lat || row.Lat || row.LAT),
Â  Â  Â  Â  lng: parseFloat(row.lng || row.Lng || row.LNG)
Â  Â  Â  })).filter(v => v.name && !isNaN(v.lat) && !isNaN(v.lng));
Â  Â  Â  displayVehicles();
Â  Â  } catch (err) {
Â  Â  Â  alert("âŒ Error loading station data: " + err.message);
Â  Â  }
Â  }

Â  loadCSV();

</script>
</body>
</html>












